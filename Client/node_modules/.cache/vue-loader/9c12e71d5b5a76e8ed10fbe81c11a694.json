{"remainingRequest":"/Users/carlottahillger/Documents/University/Web Development/user-client/Client/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/carlottahillger/Documents/University/Web Development/user-client/Client/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/carlottahillger/Documents/University/Web Development/user-client/Client/src/App.vue","mtime":1672840909579},{"path":"/Users/carlottahillger/Documents/University/Web Development/user-client/Client/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/carlottahillger/Documents/University/Web Development/user-client/Client/node_modules/@vue/cli-service/node_modules/vue-loader/lib/index.js","mtime":1672409555112}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBIZWFkZXIgZnJvbSAnQC9jb21wb25lbnRzL0hlYWRlci52dWUnCmltcG9ydCBtcXR0IGZyb20gJ21xdHQnCgpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2hvbWUnLAogIGNvbXBvbmVudHM6IHsKICAgICdtZW51LWhlYWRlcic6IEhlYWRlcgogIH0sCiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHVzZXI6ICcnLAogICAgICBpc0xvZ2dlZEluOiBmYWxzZSwKICAgICAgbGFzdE1lc3NhZ2U6IHt9LAogICAgICBzaG93Q29ubmVjdGlvbkluZm9ybWF0aW9uOiBmYWxzZSwKICAgICAgbWVzc2FnZTogJ25vbmUnLAogICAgICBjb25uZWN0aW9uOiB7CiAgICAgICAgcHJvdG9jb2w6ICd3c3MnLAogICAgICAgIGhvc3Q6ICdlMzNlNDFjMjg5YWQ0YWM2OWFlNWVmNjBmNDU2ZTljMy5zMi5ldS5oaXZlbXEuY2xvdWQnLAogICAgICAgIHBvcnQ6IDg4ODQsCiAgICAgICAgZW5kcG9pbnQ6ICcvbXF0dCcsCiAgICAgICAga2VlcGFsaXZlOiA2MCwKICAgICAgICBjbGVhbjogdHJ1ZSwKICAgICAgICBjb25uZWN0VGltZW91dDogNDAwMCwKICAgICAgICByZWNvbm5lY3RQZXJpb2Q6IDQwMDAsCiAgICAgICAgY2xpZW50SWQ6IGBtcXR0XyR7TWF0aC5yYW5kb20oKS50b1N0cmluZygxNikuc2xpY2UoMyl9YCwKICAgICAgICB1c2VybmFtZTogJ2dyb3VwNl9kZW50aXN0aW1vJywKICAgICAgICBwYXNzd29yZDogJ2RlbnRpc3RpbW8xMjMhJwogICAgICB9LAogICAgICByZWNlaXZlTmV3czoge30sCiAgICAgIHFvc0xpc3Q6IFswLCAxLCAyXSwKICAgICAgY2xpZW50OiB7CiAgICAgICAgY29ubmVjdGVkOiBmYWxzZQogICAgICB9LAogICAgICBzdWJzY3JpYmVTdWNjZXNzOiBmYWxzZSwKICAgICAgY29ubmVjdGluZzogZmFsc2UsCiAgICAgIHJldHJ5VGltZXM6IDAKICAgIH0KICB9LAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmNyZWF0ZUNvbm5lY3Rpb24oKQogICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpID09PSBudWxsKSB7CiAgICAgIHRoaXMuJHJvdXRlci5wdXNoKCcvc2lnbi1pbicpCiAgICAgIHRoaXMuaXNMb2dnZWRJbiA9IGZhbHNlCiAgICB9IGVsc2UgewogICAgICB0aGlzLmlzTG9nZ2VkSW4gPSB0cnVlCiAgICAgIHRoaXMudXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJykpCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBpbml0RGF0YSgpIHsKICAgICAgdGhpcy5jbGllbnQgPSB7CiAgICAgICAgY29ubmVjdGVkOiBmYWxzZQogICAgICB9CiAgICAgIHRoaXMucmV0cnlUaW1lcyA9IDAKICAgICAgdGhpcy5jb25uZWN0aW5nID0gZmFsc2UKICAgICAgdGhpcy5zdWJzY3JpYmVTdWNjZXNzID0gZmFsc2UKICAgIH0sCiAgICBoYW5kbGVPblJlQ29ubmVjdCgpIHsKICAgICAgdGhpcy5yZXRyeVRpbWVzICs9IDEKICAgICAgaWYgKHRoaXMucmV0cnlUaW1lcyA+IDUpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5jbGllbnQuZW5kKCkKICAgICAgICAgIHRoaXMuaW5pdERhdGEoKQogICAgICAgICAgdGhpcy4kbWVzc2FnZS5lcnJvcignQ29ubmVjdGlvbiBtYXhSZWNvbm5lY3RUaW1lcyBsaW1pdCwgc3RvcCByZXRyeScpCiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgIC8vIHRoaXMuJG1lc3NhZ2UuZXJyb3IoZXJyb3IudG9TdHJpbmcoKSkKICAgICAgICAgIGNvbnNvbGUubG9nKGVycm9yKQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNyZWF0ZUNvbm5lY3Rpb24oKSB7CiAgICAgIHRyeSB7CiAgICAgICAgdGhpcy5jb25uZWN0aW5nID0gdHJ1ZQogICAgICAgIGNvbnN0IHsgcHJvdG9jb2wsIGhvc3QsIHBvcnQsIGVuZHBvaW50LCAuLi5vcHRpb25zIH0gPSB0aGlzLmNvbm5lY3Rpb24KICAgICAgICBjb25zdCBjb25uZWN0VXJsID0gYCR7cHJvdG9jb2x9Oi8vJHtob3N0fToke3BvcnR9JHtlbmRwb2ludH1gCiAgICAgICAgY29uc29sZS5sb2coY29ubmVjdFVybCkKICAgICAgICB0aGlzLmNsaWVudCA9IG1xdHQuY29ubmVjdChjb25uZWN0VXJsLCBvcHRpb25zKQogICAgICAgIGNvbnNvbGUubG9nKHRoaXMuY2xpZW50KQogICAgICAgIGlmICh0aGlzLmNsaWVudC5vbikgewogICAgICAgICAgdGhpcy5jbGllbnQub24oJ2Nvbm5lY3QnLCAoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuY29ubmVjdGluZyA9IGZhbHNlCiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb25uZWN0aW9uIHN1Y2NlZWRlZCEnKQogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMuY2xpZW50Lm9uKCdyZWNvbm5lY3QnLCB0aGlzLmhhbmRsZU9uUmVDb25uZWN0KQogICAgICAgICAgdGhpcy5jbGllbnQub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdDb25uZWN0aW9uIGZhaWxlZCcsIGVycm9yKQogICAgICAgICAgfSkKICAgICAgICAgIHRoaXMuY2xpZW50Lm9uKCdtZXNzYWdlJywgKHRvcGljLCBtZXNzYWdlKSA9PiB7CiAgICAgICAgICAgIGNvbnN0IGpzb25TdHJpbmcgPSBCdWZmZXIuZnJvbShtZXNzYWdlKS50b1N0cmluZygndXRmOCcpCiAgICAgICAgICAgIGxldCBwYXJzZWREYXRhID0ganNvblN0cmluZwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHBhcnNlZERhdGEgPSBKU09OLnBhcnNlKGpzb25TdHJpbmcpCiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyb3IpCiAgICAgICAgICAgIH0KICAgICAgICAgICAgdGhpcy5yZWNlaXZlTmV3cyA9IHsgbXNnOiBwYXJzZWREYXRhLCB0b3BpYzogdG9waWMgfQogICAgICAgICAgfSkKICAgICAgICB9CiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgdGhpcy5jb25uZWN0aW5nID0gZmFsc2UKICAgICAgICBjb25zb2xlLmxvZygnbXF0dC5jb25uZWN0IGVycm9yJywgZXJyb3IpCiAgICAgIH0KICAgIH0sCiAgICBkb1N1YnNjcmliZShzdWJUb3BpYykgewogICAgICBjb25zdCBxb3MgPSAyCiAgICAgIHRoaXMuY2xpZW50LnN1YnNjcmliZShzdWJUb3BpYywgeyBxb3MgfSwgKGVycm9yLCByZXMpID0+IHsKICAgICAgICBpZiAoZXJyb3IpIHsKICAgICAgICAgIGNvbnNvbGUubG9nKCdTdWJzY3JpYmUgdG8gdG9waWNzIGVycm9yJywgZXJyb3IpCiAgICAgICAgICByZXR1cm4KICAgICAgICB9CiAgICAgICAgdGhpcy5zdWJzY3JpYmVTdWNjZXNzID0gdHJ1ZQogICAgICAgIGNvbnNvbGUubG9nKCdTdWJzY3JpYmUgdG8gdG9waWNzIHJlcycsIHJlcykKICAgICAgfSkKICAgIH0sCiAgICBkb1VuU3Vic2NyaWJlKHN1YlRvcGljKSB7CiAgICAgIHRoaXMuY2xpZW50LnVuc3Vic2NyaWJlKHN1YlRvcGljLCBlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygnVW5zdWJzY3JpYmUgZXJyb3InLCBlcnJvcikKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgZG9QdWJsaXNoKHRvcGljLCBwYXlsb2FkKSB7CiAgICAgIGNvbnN0IHFvcyA9IDIKICAgICAgdGhpcy5jbGllbnQucHVibGlzaCh0b3BpYywgcGF5bG9hZCwgeyBxb3MgfSwgZXJyb3IgPT4gewogICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coJ1B1Ymxpc2ggZXJyb3InLCBlcnJvcikKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgZGVzdHJveUNvbm5lY3Rpb24oKSB7CiAgICAgIGlmICh0aGlzLmNsaWVudC5jb25uZWN0ZWQpIHsKICAgICAgICB0cnkgewogICAgICAgICAgdGhpcy5jbGllbnQuZW5kKGZhbHNlLCAoKSA9PiB7CiAgICAgICAgICAgIHRoaXMuaW5pdERhdGEoKQogICAgICAgICAgICBjb25zb2xlLmxvZygnU3VjY2Vzc2Z1bGx5IGRpc2Nvbm5lY3RlZCEnKQogICAgICAgICAgfSkKICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgY29uc29sZS5sb2coJ0Rpc2Nvbm5lY3QgZmFpbGVkJywgZXJyb3IudG9TdHJpbmcoKSkKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBsb2dpbigpIHsKICAgICAgdGhpcy5pc0xvZ2dlZEluID0gdHJ1ZQogICAgICB0aGlzLnVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKQogICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpCiAgICB9LAogICAgbG9nT3V0KCkgewogICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgndG9rZW4nLCBudWxsKQogICAgICB0aGlzLmlzTG9nZ2VkSW4gPSBmYWxzZQogICAgICB0aGlzLnVzZXIgPSB7fQogICAgICBsb2NhbFN0b3JhZ2UuY2xlYXIoKQogICAgfQogIH0KfQo="},{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsCA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">\n    <div v-if=\"isLoggedIn\">\n      <menu-header/>\n      <div>\n        <b-navbar toggleable=\"lg\" type=\"dark\">\n          <b-navbar-brand router-link class=\"nav-link\" to=\"/\">\n              <b-icon icon=\"house-door-fill\" aria-hidden=\"true\"></b-icon>\n            </b-navbar-brand>\n          <b-navbar-toggle target=\"nav-collapse\"></b-navbar-toggle>\n          <b-collapse id=\"nav-collapse\" is-nav>\n            <!-- Right aligned nav items -->\n            <b-navbar-nav class=\"ml-auto\">\n              <router-link class=\"nav-link\" to=\"/calendar\" >Calendar</router-link>\n                <router-link class=\"nav-link\" to=\"/search-appointment\" >Search Appointment</router-link>\n              <b-nav-item-dropdown right>\n                <!-- Using 'button-content' slot -->\n                <template #button-content>\n                  <b-icon icon=\"person-circle\" aria-hidden=\"true\"></b-icon>\n                </template>\n                <b-dropdown-item router-link class=\"nav-link\" to=\"/user\" v-bind:userId=\"this.user\">Profile</b-dropdown-item>\n                <b-dropdown-item router-link class=\"nav-link\" to=\"/sign-in\" v-on:click=\"logOut()\">Sign Out</b-dropdown-item>\n              </b-nav-item-dropdown>\n            </b-navbar-nav>\n          </b-collapse>\n        </b-navbar>\n      </div>\n      <!-- Render the content of the current page view -->\n      <router-view v-bind:message=\"this.receiveNews\" v-bind:user=\"this.user\"/>\n    </div>\n    <div v-else>\n      <!-- Render the content of the current page view -->\n      <router-view v-bind:message=\"this.receiveNews\"/>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Header from '@/components/Header.vue'\nimport mqtt from 'mqtt'\n\nexport default {\n  name: 'home',\n  components: {\n    'menu-header': Header\n  },\n  data() {\n    return {\n      user: '',\n      isLoggedIn: false,\n      lastMessage: {},\n      showConnectionInformation: false,\n      message: 'none',\n      connection: {\n        protocol: 'wss',\n        host: 'e33e41c289ad4ac69ae5ef60f456e9c3.s2.eu.hivemq.cloud',\n        port: 8884,\n        endpoint: '/mqtt',\n        keepalive: 60,\n        clean: true,\n        connectTimeout: 4000,\n        reconnectPeriod: 4000,\n        clientId: `mqtt_${Math.random().toString(16).slice(3)}`,\n        username: 'group6_dentistimo',\n        password: 'dentistimo123!'\n      },\n      receiveNews: {},\n      qosList: [0, 1, 2],\n      client: {\n        connected: false\n      },\n      subscribeSuccess: false,\n      connecting: false,\n      retryTimes: 0\n    }\n  },\n  mounted() {\n    this.createConnection()\n    if (localStorage.getItem('token') === null) {\n      this.$router.push('/sign-in')\n      this.isLoggedIn = false\n    } else {\n      this.isLoggedIn = true\n      this.user = JSON.parse(localStorage.getItem('token'))\n    }\n  },\n  methods: {\n    initData() {\n      this.client = {\n        connected: false\n      }\n      this.retryTimes = 0\n      this.connecting = false\n      this.subscribeSuccess = false\n    },\n    handleOnReConnect() {\n      this.retryTimes += 1\n      if (this.retryTimes > 5) {\n        try {\n          this.client.end()\n          this.initData()\n          this.$message.error('Connection maxReconnectTimes limit, stop retry')\n        } catch (error) {\n          // this.$message.error(error.toString())\n          console.log(error)\n        }\n      }\n    },\n    createConnection() {\n      try {\n        this.connecting = true\n        const { protocol, host, port, endpoint, ...options } = this.connection\n        const connectUrl = `${protocol}://${host}:${port}${endpoint}`\n        console.log(connectUrl)\n        this.client = mqtt.connect(connectUrl, options)\n        console.log(this.client)\n        if (this.client.on) {\n          this.client.on('connect', () => {\n            this.connecting = false\n            console.log('Connection succeeded!')\n          })\n          this.client.on('reconnect', this.handleOnReConnect)\n          this.client.on('error', (error) => {\n            console.log('Connection failed', error)\n          })\n          this.client.on('message', (topic, message) => {\n            const jsonString = Buffer.from(message).toString('utf8')\n            let parsedData = jsonString\n            try {\n              parsedData = JSON.parse(jsonString)\n            } catch (error) {\n              console.log(error)\n            }\n            this.receiveNews = { msg: parsedData, topic: topic }\n          })\n        }\n      } catch (error) {\n        this.connecting = false\n        console.log('mqtt.connect error', error)\n      }\n    },\n    doSubscribe(subTopic) {\n      const qos = 2\n      this.client.subscribe(subTopic, { qos }, (error, res) => {\n        if (error) {\n          console.log('Subscribe to topics error', error)\n          return\n        }\n        this.subscribeSuccess = true\n        console.log('Subscribe to topics res', res)\n      })\n    },\n    doUnSubscribe(subTopic) {\n      this.client.unsubscribe(subTopic, error => {\n        if (error) {\n          console.log('Unsubscribe error', error)\n        }\n      })\n    },\n    doPublish(topic, payload) {\n      const qos = 2\n      this.client.publish(topic, payload, { qos }, error => {\n        if (error) {\n          console.log('Publish error', error)\n        }\n      })\n    },\n    destroyConnection() {\n      if (this.client.connected) {\n        try {\n          this.client.end(false, () => {\n            this.initData()\n            console.log('Successfully disconnected!')\n          })\n        } catch (error) {\n          console.log('Disconnect failed', error.toString())\n        }\n      }\n    },\n    login() {\n      this.isLoggedIn = true\n      this.user = JSON.parse(localStorage.getItem('token'))\n      this.$router.push('/')\n    },\n    logOut() {\n      localStorage.setItem('token', null)\n      this.isLoggedIn = false\n      this.user = {}\n      localStorage.clear()\n    }\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: 'Avenir', Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n}\n#nav {\n  padding: 1rem 1.5rem;\n  background-color: #0092CA;\n}\n.nav-link{\n    font-size: 2rem;\n    font-weight: 500;\n    color: #ffffff;\n}\n.navbar {\n  font-style: bold;\n  background-color: #0092CA;\n  font-family: Arial, sans-serif;\n  font-weight: 400;\n}\n.navbar-nav {\n  margin-left: 30px;\n  margin-right: 30px;\n}\n\nb-icon {\n  min-width: 150%;\n  min-height: 150%;\n}\n</style>\n"]}]}